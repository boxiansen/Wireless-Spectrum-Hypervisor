clear all;close all;clc

NDFT = 384;

local_pss = [+5.437968e-03 + +3.713551e-03i, +4.942456e-03 + +3.274232e-03i, +3.539588e-03 + +2.058979e-03i, +1.466633e-03 + +3.535623e-04i, -9.291096e-04 + -1.435329e-03i, -3.252485e-03 + -2.868753e-03i, -5.129555e-03 + -3.571691e-03i, -6.270342e-03 + -3.316164e-03i, -6.513678e-03 + -2.073556e-03i, -5.846734e-03 + -2.505584e-05i, -4.397119e-03 + +2.471929e-03i, -2.401062e-03 + +4.954174e-03i, -1.556167e-04 + +6.944898e-03i, +2.034618e-03 + +8.048520e-03i, +3.905719e-03 + +8.028225e-03i, +5.269147e-03 + +6.850585e-03i, +6.028227e-03 + +4.688723e-03i, +6.176065e-03 + +1.884315e-03i, +5.778411e-03 + -1.122638e-03i, +4.947679e-03 + -3.880782e-03i, +3.815164e-03 + -6.012702e-03i, +2.507584e-03 + -7.281018e-03i, +1.131882e-03 + -7.622516e-03i, -2.306939e-04 + -7.144871e-03i, -1.522797e-03 + -6.088681e-03i, -2.704809e-03 + -4.764895e-03i, -3.748128e-03 + -3.482552e-03i, -4.630953e-03 + -2.483106e-03i, -5.337996e-03 + -1.895351e-03i, -5.863587e-03 + -1.719644e-03i, -6.216098e-03 + -1.843125e-03i, -6.420873e-03 + -2.080476e-03i, -6.519312e-03 + -2.229212e-03i, -6.562957e-03 + -2.125619e-03i, -6.603356e-03 + -1.687951e-03i, -6.680128e-03 + -9.370557e-04i, -6.810696e-03 + +9.683617e-06i, -6.985141e-03 + +9.686337e-04i, -7.168364e-03 + +1.736265e-03i, -7.309754e-03 + +2.139738e-03i, -7.358210e-03 + +2.079178e-03i, -7.278460e-03 + +1.551389e-03i, -7.063790e-03 + +6.494914e-04i, -6.740821e-03 + -4.610284e-04i, -6.363910e-03 + -1.583563e-03i, -5.999622e-03 + -2.538437e-03i, -5.704776e-03 + -3.205603e-03i, -5.503886e-03 + -3.551237e-03i, -5.372829e-03 + -3.631414e-03i, -5.234621e-03 + -3.571782e-03i, -4.970543e-03 + -3.528183e-03i, -4.445951e-03 + -3.638007e-03i, -3.545997e-03 + -3.974710e-03i, -2.213156e-03 + -4.517504e-03i, -4.768886e-04 + -5.144859e-03i, +1.533321e-03 + -5.654988e-03i, +3.597176e-03 + -5.809956e-03i, +5.435701e-03 + -5.394127e-03i, +6.761352e-03 + -4.273756e-03i, +7.336373e-03 + -2.443481e-03i, +7.026713e-03 + -4.775395e-05i, +5.838831e-03 + +2.629690e-03i, +3.929717e-03 + +5.208285e-03i, +1.585948e-03 + +7.277910e-03i, -8.255453e-04 + +8.477984e-03i, -2.925716e-03 + +8.572219e-03i, -4.396573e-03 + +7.503103e-03i, -5.043505e-03 + +5.413800e-03i, -4.832797e-03 + +2.631578e-03i, -3.895537e-03 + -3.853524e-04i, -2.496473e-03 + -3.128129e-03i, -9.742589e-04 + -5.129480e-03i, +3.338504e-04 + -6.050044e-03i, +1.166019e-03 + -5.741821e-03i, +1.391861e-03 + -4.276242e-03i, +1.037627e-03 + -1.931270e-03i, +2.747730e-04 + +8.600203e-04i, -6.255146e-04 + +3.589363e-03i, -1.361303e-03 + +5.766298e-03i, -1.676315e-03 + +7.006442e-03i, -1.425794e-03 + +7.098521e-03i, -6.162032e-04 + +6.038087e-03i, +5.909338e-04 + +4.022555e-03i, +1.912391e-03 + +1.409826e-03i, +3.006547e-03 + -1.350430e-03i, +3.552310e-03 + -3.798864e-03i, +3.325640e-03 + -5.546083e-03i, +2.256055e-03 + -6.335245e-03i, +4.500140e-04 + -6.077134e-03i, -1.824397e-03 + -4.853075e-03i, -4.188292e-03 + -2.887525e-03i, -6.227124e-03 + -4.978178e-04i, -7.573575e-03 + +1.967658e-03i, -7.980056e-03 + +4.190261e-03i, -7.365354e-03 + +5.929627e-03i, -5.825911e-03 + +7.052111e-03i, -3.610432e-03 + +7.536043e-03i, -1.064575e-03 + +7.455626e-03i, +1.441088e-03 + +6.949413e-03i, +3.583534e-03 + +6.181742e-03i, +5.144527e-03 + +5.305969e-03i, +6.041246e-03 + +4.436924e-03i, +6.325558e-03 + +3.637106e-03i, +6.154608e-03 + +2.917559e-03i, +5.741768e-03 + +2.251015e-03i, +5.300893e-03 + +1.592370e-03i, +4.997409e-03 + +9.004456e-04i, +4.917081e-03 + +1.554164e-04i, +5.058162e-03 + -6.321116e-04i, +5.346491e-03 + -1.421873e-03i, +5.667404e-03 + -2.153510e-03i, +5.904648e-03 + -2.761751e-03i, +5.975459e-03 + -3.192838e-03i, +5.852858e-03 + -3.417811e-03i, +5.570278e-03 + -3.439289e-03i, +5.208685e-03 + -3.290213e-03i, +4.871117e-03 + -3.025041e-03i, +4.652597e-03 + -2.705784e-03i, +4.614155e-03 + -2.386382e-03i, +4.767930e-03 + -2.099297e-03i, +5.076753e-03 + -1.847470e-03i, +5.467215e-03 + -1.603570e-03i, +5.851370e-03 + -1.316622e-03i, +6.149855e-03 + -9.245505e-04i, +6.309247e-03 + -3.698501e-04i, +6.308526e-03 + +3.849495e-04i, +6.153264e-03 + +1.345230e-03i, +5.860277e-03 + +2.477984e-03i, +5.438831e-03 + +3.712431e-03i, +4.875897e-03 + +4.947290e-03i, +4.132068e-03 + +6.063323e-03i, +3.151571e-03 + +6.938908e-03i, +1.885242e-03 + +7.466177e-03i, +3.207067e-04 + +7.565389e-03i, -1.489372e-03 + +7.195771e-03i, -3.411035e-03 + +6.361776e-03i, -5.232830e-03 + +5.114390e-03i, -6.693084e-03 + +3.547689e-03i, -7.527819e-03 + +1.791189e-03i, -7.530249e-03 + -1.306576e-06i, -6.608226e-03 + -1.665535e-03i, -4.824658e-03 + -3.042423e-03i, -2.408226e-03 + -3.994480e-03i, +2.722533e-04 + -4.421606e-03i, +2.768264e-03 + -4.274679e-03i, +4.636537e-03 + -3.565070e-03i, +5.531275e-03 + -2.368205e-03i, +5.283072e-03 + -8.197045e-04i, +3.945320e-03 + +8.966044e-04i, +1.795019e-03 + +2.568404e-03i, -7.154589e-04 + +3.980505e-03i, -3.047907e-03 + +4.943342e-03i, -4.691388e-03 + +5.320307e-03i, -5.274727e-03 + +5.049562e-03i, -4.653025e-03 + +4.156413e-03i, -2.947558e-03 + +2.753497e-03i, -5.280398e-04 + +1.027910e-03i, +2.061045e-03 + -7.834313e-04i, +4.215638e-03 + -2.426846e-03i, +5.404467e-03 + -3.668346e-03i, +5.289537e-03 + -4.327751e-03i, +3.807525e-03 + -4.304940e-03i, +1.192929e-03 + -3.593923e-03i, -2.063540e-03 + -2.282548e-03i, -5.313446e-03 + -5.380274e-04i, -7.885238e-03 + +1.419068e-03i, -9.225808e-03 + +3.347774e-03i, -9.017990e-03 + +5.021103e-03i, -7.248063e-03 + +6.256179e-03i, -4.208348e-03 + +6.935607e-03i, -4.345016e-04 + +7.017257e-03i, +3.408385e-03 + +6.531915e-03i, +6.665332e-03 + +5.570384e-03i, +8.825616e-03 + +4.263303e-03i, +9.621998e-03 + +2.757934e-03i, +9.073840e-03 + +1.196162e-03i, +7.465937e-03 + -3.027619e-04i, +5.269704e-03 + -1.652620e-03i, +3.026363e-03 + -2.803224e-03i, +1.220117e-03 + -3.736996e-03i, +1.709156e-04 + -4.461201e-03i, -2.887164e-05 + -4.998386e-03i, +4.795087e-04 + -5.377420e-03i, +1.371939e-03 + -5.626909e-03i, +2.234908e-03 + -5.771729e-03i, +2.677755e-03 + -5.832528e-03i, +2.435676e-03 + -5.827223e-03i, +1.438306e-03 + -5.773188e-03i, -1.724295e-04 + -5.688869e-03i, -2.078795e-03 + -5.594025e-03i, -3.868192e-03 + -5.508376e-03i, -5.137794e-03 + -5.449089e-03i, -5.596440e-03 + -5.427950e-03i, -5.138136e-03 + -5.449150e-03i, -3.868806e-03 + -5.508472e-03i, -2.079558e-03 + -5.594118e-03i, -1.731896e-04 + -5.688917e-03i, +1.437702e-03 + -5.773157e-03i, +2.435351e-03 + -5.827102e-03i, +2.677781e-03 + -5.832335e-03i, +2.235291e-03 + -5.771512e-03i, +1.372625e-03 + -5.626737e-03i, +4.803945e-04 + -5.377369e-03i, -2.791326e-05 + -4.998519e-03i, +1.718194e-04 + -4.461554e-03i, +1.220864e-03 + -3.737563e-03i, +3.026892e-03 + -2.803953e-03i, +5.270003e-03 + -1.653420e-03i, +7.466036e-03 + -3.035136e-04i, +9.073797e-03 + +1.195580e-03i, +9.621884e-03 + +2.757622e-03i, +8.825496e-03 + +4.263323e-03i, +6.665244e-03 + +5.570739e-03i, +3.408339e-03 + +6.532549e-03i, -4.345224e-04 + +7.018060e-03i, -4.208384e-03 + +6.936437e-03i, -7.248161e-03 + +6.256885e-03i, -9.018197e-03 + +5.021553e-03i, -9.226141e-03 + +3.347883e-03i, -7.885701e-03 + +1.418809e-03i, -5.314011e-03 + -5.386132e-04i, -2.064161e-03 + -2.283362e-03i, +1.192305e-03 + -3.594828e-03i, +3.806951e-03 + -4.305788e-03i, +5.289054e-03 + -4.328413e-03i, +5.404098e-03 + -3.668733e-03i, +4.215387e-03 + -2.426931e-03i, +2.060903e-03 + -7.832479e-04i, -5.280912e-04 + +1.028275e-03i, -2.947539e-03 + +2.753920e-03i, -4.652950e-03 + +4.156766e-03i, -5.274602e-03 + +5.049735e-03i, -4.691217e-03 + +5.320232e-03i, -3.047691e-03 + +4.943013e-03i, -7.152057e-04 + +3.979967e-03i, +1.795296e-03 + +2.567751e-03i, +3.945594e-03 + +8.959552e-04i, +5.283308e-03 + -8.202340e-04i, +5.531439e-03 + -2.368522e-03i, +4.636601e-03 + -3.565133e-03i, +2.768214e-03 + -4.274496e-03i, +2.721030e-04 + -4.421242e-03i, -2.408444e-03 + -3.994038e-03i, -4.824890e-03 + -3.042019e-03i, -6.608413e-03 + -1.665273e-03i, -7.530338e-03 + -1.255628e-06i, -7.527782e-03 + +1.791014e-03i, -6.692923e-03 + +3.547328e-03i, -5.232587e-03 + +5.113936e-03i, -3.410785e-03 + +6.361349e-03i, -1.489212e-03 + +7.195497e-03i, +3.206817e-04 + +7.565370e-03i, +1.884959e-03 + +7.466468e-03i, +3.150996e-03 + +6.939499e-03i, +4.131221e-03 + +6.064144e-03i, +4.874849e-03 + +4.948215e-03i, +5.437700e-03 + +3.713300e-03i, +5.859204e-03 + +2.478644e-03i, +6.152382e-03 + +1.345552e-03i, +6.307945e-03 + +3.848616e-04i, +6.309019e-03 + -3.703531e-04i, +6.149970e-03 + -9.254006e-04i, +5.851755e-03 + -1.317695e-03i, +5.467751e-03 + -1.604702e-03i, +5.077294e-03 + -1.848495e-03i, +4.768340e-03 + -2.100071e-03i, +4.614330e-03 + -2.386815e-03i, +4.652490e-03 + -2.705844e-03i, +4.870745e-03 + -3.024768e-03i, +5.208123e-03 + -3.289699e-03i, +5.569640e-03 + -3.438663e-03i, +5.852275e-03 + -3.417208e-03i, +5.975043e-03 + -3.192375e-03i, +5.904475e-03 + -2.761503e-03i, +5.667486e-03 + -2.153500e-03i, +5.346783e-03 + -1.422071e-03i, +5.058568e-03 + -6.324415e-04i, +4.917476e-03 + +1.550547e-04i, +4.997666e-03 + +9.001529e-04i, +5.300911e-03 + +1.592228e-03i, +5.741496e-03 + +2.251069e-03i, +6.154057e-03 + +2.917808e-03i, +6.324800e-03 + +3.637509e-03i, +6.040397e-03 + +4.437409e-03i, +5.143726e-03 + +5.306448e-03i, +3.582916e-03 + +6.182140e-03i, +1.440754e-03 + +6.949672e-03i, -1.064573e-03 + +7.455729e-03i, -3.610101e-03 + +7.536006e-03i, -5.825316e-03 + +7.051983e-03i, -7.364602e-03 + +5.929472e-03i, -7.979274e-03 + +4.190150e-03i, -7.572882e-03 + +1.967642e-03i, -6.226619e-03 + -4.977175e-04i, -4.188025e-03 + -2.887321e-03i, -1.824375e-03 + -4.852813e-03i, +4.498335e-04 + -6.076882e-03i, +2.255745e-03 + -6.335082e-03i, +3.325291e-03 + -5.546073e-03i, +3.552009e-03 + -3.799050e-03i, +3.006364e-03 + -1.350817e-03i, +1.912369e-03 + +1.409270e-03i, +5.910799e-04 + +4.021895e-03i, -6.159110e-04 + +6.037406e-03i, -1.425403e-03 + +7.097909e-03i, -1.675880e-03 + +7.005973e-03i, -1.360883e-03 + +5.766022e-03i, -6.251541e-04 + +3.589291e-03i, +2.750430e-04 + +8.601286e-04i, +1.037798e-03 + -1.931031e-03i, +1.391944e-03 + -4.275938e-03i, +1.166038e-03 + -5.741515e-03i, +3.338348e-04 + -6.049789e-03i, -9.742717e-04 + -5.129294e-03i, -2.496457e-03 + -3.128005e-03i, -3.895473e-03 + -3.852540e-04i, -4.832678e-03 + +2.631706e-03i, -5.043340e-03 + +5.414017e-03i, -4.396381e-03 + +7.503456e-03i, -2.925528e-03 + +8.572729e-03i, -8.253956e-04 + +8.478644e-03i, +1.586025e-03 + +7.278679e-03i, +3.929694e-03 + +5.209093e-03i, +5.838693e-03 + +2.630452e-03i, +7.026466e-03 + -4.711762e-05i, +7.336041e-03 + -2.443041e-03i, +6.760975e-03 + -4.273548e-03i, +5.435334e-03 + -5.394159e-03i, +3.596880e-03 + -5.810201e-03i, +1.533149e-03 + -5.655393e-03i, -4.768968e-04 + -5.145355e-03i, -2.212990e-03 + -4.518026e-03i, -3.545677e-03 + -3.975203e-03i, -4.445526e-03 + -3.638437e-03i, -4.970090e-03 + -3.528545e-03i, -5.234226e-03 + -3.572090e-03i, -5.372574e-03 + -3.631696e-03i, -5.503834e-03 + -3.551528e-03i, -5.704950e-03 + -3.205925e-03i, -6.000007e-03 + -2.538799e-03i, -6.364447e-03 + -1.583951e-03i, -6.741422e-03 + -4.614048e-04i, -7.064348e-03 + +6.491748e-04i, -7.278878e-03 + +1.551186e-03i, -7.358418e-03 + +2.079131e-03i, -7.309726e-03 + +2.139872e-03i, -7.168122e-03 + +1.736578e-03i, -6.984757e-03 + +9.690945e-04i, -6.810276e-03 + +1.023727e-05i, -6.679792e-03 + -9.364806e-04i, -6.603208e-03 + -1.687427e-03i, -6.563067e-03 + -2.125207e-03i, -6.519697e-03 + -2.228952e-03i, -6.421494e-03 + -2.080377e-03i, -6.216867e-03 + -1.843166e-03i, -5.864387e-03 + -1.719779e-03i, -5.338699e-03 + -1.895518e-03i, -4.631456e-03 + -2.483243e-03i, -3.748371e-03 + -3.482606e-03i, -2.704787e-03 + -4.764838e-03i, -1.522560e-03 + -6.088509e-03i, -2.303349e-04 + -7.144609e-03i, +1.132249e-03 + -7.622211e-03i, +2.507852e-03 + -7.280732e-03i, +3.815262e-03 + -6.012498e-03i, +4.947584e-03 + -3.880707e-03i, +5.778153e-03 + -1.122728e-03i, +6.175720e-03 + +1.884054e-03i, +6.027897e-03 + +4.688310e-03i, +5.268936e-03 + +6.850055e-03i, +3.905698e-03 + +8.027633e-03i, +2.034806e-03 + +8.047920e-03i, -1.552594e-04 + +6.944337e-03i, -2.400633e-03 + +4.953691e-03i, -4.396754e-03 + +2.471548e-03i, -5.846574e-03 + -2.533117e-05i, -6.513838e-03 + -2.073735e-03i, -6.270884e-03 + -3.316263e-03i, -5.130464e-03 + -3.571734e-03i, -3.253666e-03 + -2.868760e-03i, -9.304084e-04 + -1.435319e-03i, +1.465413e-03 + +3.535790e-04i, +3.538641e-03 + +2.058993e-03i, +4.941940e-03 + +3.274240e-03i];

local_pss_freq = fft(local_pss,384).';

rx_pss = [+8.262246e-02 + -1.741775e-02i, +1.536160e-01 + -2.252479e-01i, +1.416810e-01 + -1.873634e-01i, -3.773253e-02 + +2.085804e-01i, +7.076357e-02 + +8.718790e-02i, -3.476156e-02 + -8.215270e-04i, -4.177770e-01 + +1.448996e-01i, -3.647503e-01 + -1.128324e-01i, +1.867528e-01 + -1.365651e-01i, +3.585259e-01 + +1.069816e-01i, -8.214655e-02 + -4.942792e-02i, -1.602453e-01 + -2.221454e-01i, -1.536775e-01 + -7.600015e-02i, -6.867696e-02 + -7.051747e-02i, +3.613603e-01 + -1.790279e-01i, +2.636444e-02 + +2.255488e-02i, -1.368167e-02 + +3.153596e-02i, +4.760864e-01 + -1.074793e-01i, -7.380770e-02 + +2.301136e-01i, -6.619496e-02 + +2.290109e-01i, +3.777828e-01 + -2.029789e-01i, -2.395200e-01 + -6.175433e-02i, -2.161500e-01 + +2.581632e-01i, +2.220334e-01 + +1.956111e-01i, -1.268127e-01 + +8.724120e-02i, -2.650432e-01 + +1.081983e-01i, -7.976117e-02 + +4.491283e-02i, +3.531266e-02 + +4.287067e-02i, +1.570490e-02 + +1.853802e-01i, -2.423978e-01 + -1.684858e-01i, -1.878893e-01 + -4.749902e-01i, +2.039597e-01 + +2.341133e-02i, +3.558801e-02 + +2.454622e-01i, -4.265457e-01 + +6.858185e-02i, -2.424671e-01 + +1.233620e-01i, -1.310645e-01 + -1.801423e-02i, -3.513059e-01 + -2.146110e-01i, +5.107680e-02 + -1.542873e-01i, +3.604612e-01 + -1.782661e-02i, +8.362911e-02 + -3.972038e-02i, -1.612615e-01 + -2.153801e-01i, -4.560306e-01 + -2.393171e-02i, -4.395370e-01 + +1.021573e-01i, -4.108422e-02 + -1.664663e-01i, +1.400265e-01 + -7.353947e-03i, +1.198338e-01 + +1.252679e-01i, -1.308405e-01 + -1.191289e-01i, -3.439346e-01 + -3.284422e-02i, -1.653998e-01 + +1.158063e-01i, +9.082184e-02 + +1.373657e-01i, +4.809622e-02 + +7.379590e-03i, -3.038187e-01 + -2.499124e-01i, -2.555949e-01 + +6.559927e-03i, +1.060902e-01 + +1.559384e-01i, -3.727878e-02 + +8.522905e-03i, -6.229952e-02 + +4.499280e-01i, +1.861796e-01 + +3.109594e-01i, -8.732505e-03 + -4.203005e-01i, -8.266657e-02 + +1.684558e-02i, +1.698449e-01 + +4.157283e-01i, +1.532200e-01 + -1.088150e-01i, +9.821130e-02 + -1.320490e-01i, +1.070661e-01 + +9.264243e-02i, -3.624448e-02 + -1.429882e-02i, +4.750639e-02 + -1.112176e-02i, +1.836264e-01 + -1.420755e-01i, -4.728364e-02 + -4.046531e-01i, -1.341660e-01 + -2.514431e-01i, -7.170050e-02 + +1.154989e-01i, -8.790269e-02 + +6.708500e-02i, +4.035979e-02 + -1.037860e-01i, -1.395279e-02 + +1.693132e-01i, -1.102625e-01 + +2.540592e-01i, -5.256492e-04 + -3.717956e-02i, -4.833550e-02 + -3.957897e-02i, +3.109298e-03 + +1.272624e-02i, +1.129205e-01 + -4.311497e-02i, -3.983935e-02 + +9.238495e-03i, -1.040567e-01 + +3.635764e-02i, +1.151388e-01 + -4.723642e-02i, +2.109587e-01 + -2.625164e-01i, -1.746694e-01 + -2.033336e-01i, -1.443265e-01 + +9.947687e-02i, +3.161066e-01 + -1.119525e-02i, +3.708968e-02 + -1.044927e-01i, -3.368622e-02 + +8.773178e-02i, +1.226990e-01 + +1.617091e-01i, -2.691905e-01 + +2.203866e-01i, +5.973028e-02 + +9.848606e-02i, +2.461822e-01 + -5.302373e-02i, -3.751268e-01 + +5.828481e-02i, -2.352379e-01 + -3.823438e-02i, -1.310565e-02 + -1.421764e-01i, -7.582236e-02 + -7.582401e-02i, +1.110285e-01 + -1.625076e-01i, -1.471104e-05 + -6.739840e-02i, -5.497682e-02 + -2.329544e-02i, -4.283447e-03 + -3.069433e-01i, -7.582971e-02 + -2.518349e-01i, +3.839097e-02 + -2.299173e-02i, +1.195912e-01 + +6.653980e-02i, +2.462556e-01 + +2.267193e-01i, +2.381286e-01 + +1.036078e-03i, +4.706556e-02 + -3.120790e-01i, +1.392310e-01 + -1.352196e-02i, +6.689781e-02 + +1.221225e-01i, -3.654894e-02 + -1.027707e-01i, +1.451337e-01 + -2.284158e-02i, +1.003506e-01 + +1.576727e-01i, +4.837362e-02 + +2.339028e-01i, +8.965765e-03 + +8.555760e-02i, -1.067225e-01 + -1.256632e-01i, +1.884532e-01 + +1.968603e-01i, +3.813047e-01 + +3.340997e-01i, +5.493006e-02 + -2.159764e-01i, -8.346584e-02 + -2.747782e-01i, +8.173620e-03 + +2.568682e-01i, -7.918029e-02 + +3.037454e-01i, -1.475288e-02 + +5.586229e-02i, +2.067379e-01 + +2.068899e-01i, +1.248512e-01 + +1.805930e-01i, +2.527722e-02 + -2.411119e-01i, +1.536086e-01 + -5.647840e-02i, +1.287530e-01 + +2.746155e-01i, -3.232098e-02 + -6.969680e-02i, +6.046831e-02 + -1.444549e-01i, +1.931514e-01 + +1.386875e-01i, +6.170444e-02 + +1.358660e-01i, +1.344394e-01 + +1.112510e-01i, +1.743382e-01 + -5.145575e-02i, -1.339736e-01 + -2.530647e-01i, +9.043342e-02 + -6.279165e-02i, +3.279224e-01 + -4.917590e-03i, +9.181499e-03 + -2.010971e-01i, +4.336215e-02 + -1.725500e-01i, +8.611226e-02 + -1.090730e-01i, -1.343106e-01 + -9.965541e-02i, -2.821884e-01 + -4.750033e-02i, -2.187773e-01 + -8.748632e-02i, +2.183219e-01 + -3.320462e-02i, -2.372404e-02 + +6.197754e-02i, -3.440868e-01 + +3.251838e-02i, +1.663918e-01 + +1.080153e-02i, -1.143133e-01 + -1.306307e-01i, -2.508719e-01 + +3.196051e-02i, +3.534564e-01 + +3.455692e-01i, +5.622046e-03 + -7.414261e-02i, -4.894509e-02 + -9.736991e-02i, +2.734433e-01 + +3.739742e-01i, -9.542040e-02 + -7.007965e-02i, +1.789129e-02 + -2.535602e-01i, +1.065491e-01 + +1.078955e-01i, -2.512863e-01 + -1.313667e-01i, -6.639601e-02 + -2.539192e-01i, +1.651281e-01 + -1.550448e-01i, +2.813623e-02 + -1.598329e-01i, -6.282293e-02 + +4.580854e-02i, +8.213293e-03 + +1.884482e-01i, -1.956139e-02 + +1.927209e-01i, -2.668175e-03 + +7.122434e-02i, +1.820525e-01 + -1.410978e-02i, -6.126200e-02 + +9.205201e-02i, -1.510334e-01 + +6.214635e-03i, +2.248156e-01 + -8.333848e-02i, +2.760478e-02 + -2.039178e-02i, -2.652806e-01 + +7.592387e-03i, -1.461488e-01 + -2.243476e-03i, -1.391216e-01 + -1.103858e-01i, -1.737604e-01 + -1.861969e-01i, -2.099260e-02 + -2.173665e-01i, +2.718722e-01 + -7.448822e-02i, +2.189702e-01 + -1.286578e-02i, -3.676854e-02 + -2.283336e-01i, +5.376177e-02 + +4.059947e-02i, +1.536125e-01 + +1.077601e-01i, +2.595231e-01 + -7.282397e-02i, +1.936941e-01 + +3.687178e-01i, -1.110185e-01 + +7.400703e-02i, -8.212625e-04 + -2.804526e-01i, +6.866448e-02 + +1.433548e-01i, +1.495714e-02 + +7.990163e-03i, +9.817358e-02 + +1.705809e-01i, -1.362865e-01 + +2.419725e-01i, -1.493097e-01 + -1.486824e-01i, +3.816320e-02 + +2.752633e-01i, -3.243582e-02 + +1.664507e-01i, +2.211151e-02 + -7.928635e-02i, -4.577295e-02 + +1.471736e-01i, -2.301420e-02 + -1.359007e-01i, +2.186875e-01 + +3.049880e-01i, -1.284556e-01 + +3.352588e-01i, -4.829754e-01 + -3.480306e-01i, -1.485298e-01 + +1.081914e-01i, +6.468252e-02 + +6.405240e-02i, -1.472152e-01 + -8.542474e-02i, -3.865761e-02 + +3.545021e-01i, +2.047581e-01 + +2.540991e-02i, -1.469050e-01 + +7.705673e-02i, -3.183326e-01 + +1.158833e-01i, +4.263167e-02 + -1.163574e-01i, +1.526749e-01 + +2.781264e-01i, +2.011537e-01 + +2.799458e-02i, +7.227614e-02 + -6.908888e-02i, -4.157268e-01 + +3.434569e-01i, -3.014280e-01 + +1.418857e-01i, +2.038444e-01 + +1.530906e-01i, +1.942174e-01 + -1.101284e-02i, +9.808724e-02 + -3.035429e-01i, +1.717221e-01 + +3.328473e-02i, +4.280758e-02 + +1.837590e-01i, +8.262131e-02 + +1.561947e-01i, +2.814619e-01 + +1.031131e-02i, +6.531370e-02 + -5.761080e-02i, -3.838456e-02 + +9.048726e-02i, +1.380409e-01 + -1.882242e-01i, +5.827120e-02 + -2.599005e-01i, -7.158067e-02 + -1.950292e-01i, -1.419861e-01 + -2.791597e-01i, -8.857694e-02 + +6.137490e-02i, -4.536056e-02 + +6.034479e-02i, -1.686304e-01 + -1.552238e-01i, -1.411689e-02 + -8.971890e-03i, +3.347290e-02 + +1.521790e-01i, -2.274900e-02 + +2.822991e-01i, +6.896037e-02 + -3.438591e-02i, -1.667623e-01 + -1.694935e-01i, +8.577203e-02 + +1.534854e-01i, +3.576910e-01 + -2.525408e-02i, -1.561050e-01 + +3.457949e-03i, -1.499771e-02 + +1.893393e-01i, +9.419496e-02 + -6.599755e-02i, -2.712415e-01 + -1.459910e-01i, -1.843493e-02 + -2.777035e-01i, -3.803794e-02 + -2.459806e-01i, -2.765879e-02 + +7.760001e-03i, +2.794519e-01 + -1.035895e-02i, +2.651096e-02 + +2.330745e-01i, -2.459768e-02 + +1.752052e-01i, -2.429727e-03 + -2.472204e-01i, +5.194657e-02 + +5.217867e-02i, +3.176432e-01 + +2.176537e-01i, -1.316559e-01 + -5.786749e-02i, -3.179017e-01 + +9.538286e-02i, +1.431233e-03 + +1.806309e-01i, -1.305496e-01 + -1.197790e-01i, -9.724741e-02 + -1.754036e-01i, -5.559129e-02 + +3.244182e-02i, -6.275472e-02 + -3.715506e-02i, +7.257794e-02 + -2.242866e-01i, -1.049689e-01 + -1.162956e-01i, +4.742112e-04 + -7.769025e-02i, +1.143858e-01 + -2.090096e-01i, -1.406297e-01 + -7.071512e-02i, +1.016646e-01 + +9.511581e-02i, +3.756081e-01 + -1.440190e-01i, +1.629186e-01 + -2.302568e-01i, -2.358277e-02 + +1.518856e-01i, +9.164385e-02 + +1.679878e-01i, +1.845169e-01 + -1.235119e-01i, -1.442351e-01 + -4.488543e-02i, -7.124244e-02 + +3.483188e-02i, +4.233326e-01 + +1.245470e-02i, +2.148432e-01 + +1.352592e-01i, -5.669050e-02 + +2.155326e-01i, +1.158438e-01 + +1.166355e-01i, +9.345347e-02 + -1.127490e-01i, -9.089571e-02 + -4.935316e-02i, -1.516794e-01 + +2.156249e-01i, +1.039582e-01 + +1.406958e-01i, +2.651093e-01 + +3.779091e-02i, -3.419788e-02 + +4.794865e-02i, -2.314551e-02 + +3.897480e-02i, +2.940677e-01 + +1.482806e-01i, +2.307977e-01 + +1.472048e-01i, +4.804567e-03 + +7.528616e-02i, -1.668134e-01 + +3.798140e-02i, -1.512561e-01 + -3.964776e-02i, +1.578265e-01 + +9.729265e-02i, +2.013951e-01 + +1.447937e-01i, +2.393485e-02 + -9.932592e-02i, +2.435833e-01 + -1.108359e-01i, +3.261591e-01 + +1.991051e-02i, +6.659642e-04 + +5.744173e-02i, +4.373127e-02 + +9.246807e-02i, +1.416165e-01 + -1.639744e-02i, -5.905541e-02 + -1.367477e-01i, +2.496247e-02 + -1.581872e-01i, +7.350641e-02 + -2.470772e-01i, -4.004251e-02 + -1.303011e-01i, +9.306812e-02 + +1.104538e-01i, +4.082444e-02 + -3.885223e-02i, -5.499692e-02 + -2.632844e-01i, -3.197854e-02 + -2.452772e-01i, -2.836569e-01 + -1.479116e-01i, -1.802118e-01 + +7.162201e-02i, +7.539871e-02 + +2.513806e-01i, -2.236598e-01 + +2.611886e-01i, -1.265149e-01 + +6.774273e-02i, +2.777637e-01 + -2.218465e-01i, +1.341989e-01 + +4.874141e-02i, +3.609318e-02 + +3.393974e-01i, +3.735984e-02 + -1.065232e-01i, -1.545056e-01 + -1.912385e-01i, -7.581966e-02 + +8.934431e-02i, +2.126194e-01 + -1.256147e-01i, +2.044636e-01 + -1.757639e-01i, -1.216752e-01 + -6.145143e-02i, -1.465346e-01 + -1.577972e-01i, +9.329084e-02 + +9.282360e-03i, -3.936983e-02 + +1.608151e-01i, -1.287104e-02 + +7.367820e-02i, +1.886068e-01 + +7.715178e-02i, -7.146104e-02 + -1.918375e-03i, -1.043495e-01 + -6.961889e-02i, -3.207034e-02 + +1.230442e-01i, -2.878575e-01 + +2.037759e-01i, -4.188187e-02 + -8.141346e-02i, +2.690248e-01 + -3.069429e-01i, +1.062064e-02 + -1.275763e-01i, -1.660245e-01 + -7.750679e-02i, -1.674436e-01 + -2.459809e-01i, +2.960059e-03 + -2.968251e-02i, +3.266309e-01 + +3.564301e-02i, +3.627882e-01 + -1.417667e-01i, +2.933044e-01 + +1.580334e-01i, +7.187531e-02 + +1.758838e-01i, -3.951768e-01 + -7.444541e-02i, -2.813441e-01 + +1.574664e-01i, +2.207597e-01 + +1.167784e-01i, +1.796467e-01 + +6.285492e-02i, -7.889093e-02 + +2.703499e-01i, -3.567221e-02 + -5.662384e-02i, +1.731047e-01 + -1.090074e-01i, +3.922562e-02 + +2.020141e-01i, -4.554887e-01 + +1.066546e-02i, -3.571362e-01 + -7.967187e-02i, +4.960786e-02 + -1.649902e-02i, -4.358779e-02 + -1.165128e-02i, -5.163439e-02 + +9.725094e-02i, -1.190399e-01 + +1.159921e-02i, -3.307272e-01 + +4.158136e-03i, -3.241370e-02 + +1.718324e-02i, +1.452138e-01 + -1.974261e-01i, +6.303445e-03 + -1.367857e-01i, -8.553833e-02 + +4.114171e-03i, -2.536215e-01 + -7.803508e-02i, -2.371573e-01 + -1.442235e-01i, -2.122530e-01 + -9.028434e-02i, -1.259414e-01 + +2.792830e-02i, +9.443264e-02 + -3.484566e-03i, -6.700076e-02 + -9.300888e-03i, -9.183683e-02 + +3.193517e-02i, -1.767680e-02 + -1.157168e-01i, -1.499029e-01 + -1.047739e-01i, -6.429798e-02 + +3.542376e-02i, -2.519684e-01 + +6.372265e-02i, -2.681103e-01 + -1.430183e-02i, +1.141438e-01 + -1.762266e-01i, -1.267022e-01 + -9.860656e-03i, -1.952366e-01 + +2.525983e-01i, +1.277942e-01 + +2.068354e-01i, -4.710633e-03 + +1.309129e-01i, -1.644337e-01 + -5.025804e-02i, -6.232375e-02 + -4.459544e-02i, +2.073743e-01 + +2.694505e-01i, +1.825865e-01 + +1.157020e-01i, -9.510583e-02 + -1.682208e-01i, -6.928143e-02 + +6.415399e-02i, -9.723251e-02 + +2.259972e-01i, +1.473020e-01 + +2.647210e-03i, +4.811457e-01 + -1.252338e-01i, +1.809160e-01 + -9.592867e-02i, +4.511865e-02 + -1.894966e-01i, -2.745167e-02 + -2.566663e-01i, -1.551846e-01 + -2.014362e-01i, -8.866683e-02 + +1.116016e-02i, -3.236347e-01 + +2.730381e-01i, -9.074868e-02 + +1.229396e-01i, +1.917958e-01 + -5.244059e-02i, -2.124878e-01 + -4.430918e-02i, -4.543047e-02 + -2.239789e-01i, +1.781135e-01 + -5.309872e-02i, -3.597782e-02 + +2.399860e-01i, +4.073811e-02 + +1.075792e-01i];

rx_pss_freq = fft(rx_pss,384).';



figure;plot(abs(local_pss_freq))

figure;plot(abs(rx_pss_freq))


y = (local_pss.*rx_pss);

ycorr0 = sum(y(1:1:NDFT/2));

ycorr1 = sum(y((NDFT/2)+1:1:NDFT));

cfo_est = angle(conj(ycorr0).*ycorr1)/pi;



figure;plot(real(local_pss),imag(local_pss),'*');

figure;plot(real(rx_pss),imag(rx_pss),'*');